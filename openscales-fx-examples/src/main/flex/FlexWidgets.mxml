<?xml version="1.0" encoding="utf-8"?>
<mx:Panel 	xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%" 
	 		xmlns:resize="flex.utils.ui.resize.*" xmlns:os="http://openscales.org" creationComplete="initMap();"
	 		xmlns:control="org.openscales.component.control.*" layout="absolute" styleName="container">
	 		
	 		<mx:Style>
	 			.container {
				   borderThicknessLeft: 0;
				   borderThicknessTop: 0;
				   borderThicknessBottom: 0;
				   borderThicknessRight: 0;
				   headerHeight: 0;
				} 

	 		</mx:Style>
	
	<mx:Script>
		<![CDATA[
			import org.openscales.component.control.Control;
			import org.openscales.core.events.LayerEvent;
			import flex.utils.ui.resize.ResizableWindow;
			import org.openscales.core.handler.IHandler;
			import org.openscales.core.handler.mouse.DragHandler;
			import org.openscales.core.handler.mouse.WheelHandler;
			import mx.events.ResizeEvent;
			import org.openscales.core.Map;
			import org.openscales.core.popup.Popup;
			import org.openscales.core.control.MousePosition;
			import org.openscales.core.Marker;
			import org.openscales.core.feature.Feature;
			import org.openscales.core.layer.Markers;
			import org.openscales.core.control.PanZoom;
			import org.openscales.core.control.PanZoomBar;
			import org.openscales.core.basetypes.Bounds;
			import org.openscales.core.basetypes.LonLat;
			import org.openscales.core.basetypes.Size;
			import org.openscales.core.basetypes.Pixel;
			import org.openscales.core.control.LayerSwitcher;
			import org.openscales.core.layer.osm.OSM;
			import org.openscales.core.layer.osm.Maplint;
			import org.openscales.core.layer.osm.Mapnik;
			import org.openscales.core.layer.osm.Osmarender;
			
			[Bindable]
			public var map:Map; 
			
			public var feature:Feature; 
			
			public static var lon:Number=-43.584918945312495;
			public static var lat:Number=-3.5397294921874973;
        	
        	public var mark:Marker;

			
			private function initMap():void
			{
	   			map = fxmap.map;
				map.size=new Size(fxmap.width, fxmap.height);
				map.zoomToExtent(new Bounds(-124.731422,24.955967,-66.969849,49.371735)); 									
			}
						
			private function showPopup(e:MouseEvent):void
			{				
				var pop:Popup = feature.createPopup();			
				map.addPopup(pop);
			} 

		]]>
	</mx:Script>
	
	<resize:ResizableWindow title="Pan" movable="true" horizontalAlign="center">
		<os:PanComponent id="pan" map="{map}"/>
		<os:ZoomComponent id="zoom" map="{map}"/>
	</resize:ResizableWindow>
	
	<resize:ResizableWindow title="Capabilities" movable="true" x="34" y="418" width="440" height="339">
		<os:CapabilitiesComponent width="100%" height="100%" map="{map}" />
	</resize:ResizableWindow>
		
	<resize:ResizableWindow title="LayerSwitcher" movable="true" x="800" width="300" height="400">
		<os:LayerSwitcherComponent id="layerSwitcher" map="{map}"/>
	</resize:ResizableWindow>
	
	<resize:ResizableWindow title="Drawing" movable="true" x="546" y="418" width="250" height="220">
		<control:Drawing map="{map}">
		</control:Drawing>
	
	</resize:ResizableWindow>
	
	<resize:ResizableWindow x="100" width="600" height="400" title="OpenScales" movable="true">
		<os:Map id="fxmap" height="100%" width="100%" >

		<os:WMSC name="OpenLayers WMS" url="http://labs.metacarta.com/wms-c/Basic.py" layers="basic" isBaseLayer="true" />

		<os:WFS name="test" url="http://sigma.openplans.org/geoserver/wfs" typename="topp:poi" srs="EPSG:4326" version="1.0.0"
				isBaseLayer="false" minZoomLevel="21">
			<os:Style fillColor="0xff0000" fillOpacity="0.8" strokeColor="0x0000ff" strokeWidth="2" />
			
		</os:WFS>
		
		<!--Still an issue with ox:Extent tag that call map.zoomToExtent ... -->
		<!--os:Extent left="-124.731422" bottom="24.955967" right="-66.969849" top="49.371735" /-->
			
		<os:MousePosition />
		
		<os:DragHandler />
		<os:ClickHandler />
		<os:WheelHandler />
	</os:Map>
	</resize:ResizableWindow>
	
</mx:Panel>
